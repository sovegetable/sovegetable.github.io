{"title":"uploadlabs 题解","slug":"uploadlabs题解","date":"2020-09-15","updated":"2020-09-15","comments":true,"path":"api/posts/14880.json","excerpt":null,"cover":null,"covers":null,"content":"<p>第一关：<br>前端 js 函数白名单过滤 <br> 方法 1：BP 抓包改文件，先把 php 后缀改成白名单里的，然后抓包在改回来绕过前端 <br> 方法 2：在浏览器设置里关闭 js 函数 <br> 方法 3：在 consel 里运行改过的 html 源码（亲测未成功，js 路径报错）</p>\n<p>第二关：<br>对于 content-type 的检验<br>BP 将 text/plain 改为 image/gif</p>\n<p>第三关：<br>黑名单后缀 <br> 用类似等效的后缀代替（亦或是大小写）<br>比如说:.phtml .phps .php5 .pht，但如果上传的是.php5 这种类型文件的话，如果想要被当成 php 执行的话，需要有个前提条件，即 Apache 的 httpd.conf 有如下配置代码 <br> 大小写都可 如.PhP .pHP(亲测失败)</p>\n<p>第四关：<br>更全的黑名单 <br>.htaccess，于是首先上传一个.htaccess 内容如下的文件:<br>SetHandler application/x-httpd-php<br> 这样所有文件都会解析为 php，然后再上传图片马，就可以解析：</p>\n<p>第五关：<br>黑名单，加上了.htaccess，但是没有将后缀进行大小写统一，于是可以通过大小写绕过，在 content-disposition filename=xxx.phP</p>\n","url":"/posts/14880/","min2read":1,"word4post":291,"prev_post":null,"next_post":{"title":"OSI 七层协议","url":"/posts/10420/"},"toc":"","categories":[],"tags":[]}